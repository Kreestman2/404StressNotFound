<html>
<head>
<style>
ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: verdana;
}

li {
    float: left;
}

li a {
    display: inline-block;
    color: white;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
}

li a:hover {
    background-color: #111;
    opacity: 0.7;
}
h1 {
    text-align: center;
    font-family: verdana;
    color: white;
    font-size: 24px;
}
h2 {
    text-align: center;
    font-family: verdana;
    color: white;
    font-size: 18px;
}
h3 {
    text-align: center;
    font-family: verdana;
    color: white;
    font-size: 12px;
}
footer {
    position: fixed;
    left: 0;
    bottom: 0;
    width: 100%;
    color: white;
    text-align: center;
    font-family: verdana;
    font-size: 10px;
}
input[type=text], select, textarea {
    width: 100%; 
    border: 1px solid #ccc; 
    border-radius: 4px; 
    box-sizing: border-box; 
    margin-top: 6px; 
    margin-bottom: 16px; 
    resize: vertical s;
	
}


input[type=submit] {
    background-color: blue;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}


input[type=submit]:hover {
    background-color: black;
}
input[type=button] {
    background-color: blue;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}


container {
    border-radius: 5px;
    background-color: #f2f2f2;
    padding: 5px;
	font-family: verdana;
	color: white;
    font-size: 18px;
	height: 200px;
    width: 400px;
    position: fixed;
    top: 30%;
    left: 50%;
    margin-top: -100px;
    margin-left: -200px;
}

register {
    border-radius: 5px;
    background-color: #f2f2f2;
    padding: 5px;
	font-family: verdana;
	color: white;
    font-size: 18px;
	height: 200px;
    width: 400px;
    position: fixed;
    top: 30%;
    left: 50%;
    margin-top: -10px;
    margin-left: -200px;
}
label {
	font-family: verdana;
	color: white;
    font-size: 12px;
	float: left;
}

</style>
</head>	


	<body background="./Images/Background.png">
	<ul>
		<li><a href="./index.html">HOME</a></li>
		<li><a href="./aboutUs.html">ABOUT US</a></li>
		<li><a href="./loginRegister.html">LOGIN/REGISTER</a></li>
		<li><a href="./contactForm.html">CONTACT</a></li>
	</ul>

<div class="container">
  <!-- <form action="/action_page.php"> -->
<!-- <form id="form_id" method="post" name="loginform"> -->
<table>
<tr>
<td><label for="email">Email</label><input id="email" type="text" name="email" placeholder="Your email.." /> </td> 
<td><label for="password">Password</label><input id="password" type="text" name="password" placeholder="Your password.." />  </td>

  
<td><input type="button" value="Login" id="login" ><!--onclick="validate()"--></input></a><!--<a href="./Mymusic.html">-->
        <table id="table" border="1">
            <tbody>
                
            </tbody>
        </table>
</tr>
</table>
</div>
     <!--</form>-->
	
	<div class="register">
	<h2>Create a New Account:</h2>
   <label for="newUser">Name</label>
    <input type="text" id="newUser" name="newUser" placeholder="Name.."></input>

	<label for="newPassword">Create Password</label>
    <input type="text" id="newPassword" name="newPassword" placeholder="Create password..">
	
	<label for="newEmail">Email</label>
    <input type="text" id="newEmail" name="newEmail" placeholder="Your email..">
	
	<label for="newBirthday">Birthday</label>
<table>
<tr>
<td><select name="DOBMonth">
	<option> - Month - </option>
	<option value="January">January</option>
	<option value="Febuary">Febuary</option>
	<option value="March">March</option>
	<option value="April">April</option>
	<option value="May">May</option>
	<option value="June">June</option>
	<option value="July">July</option>
	<option value="August">August</option>
	<option value="September">September</option>
	<option value="October">October</option>
	<option value="November">November</option>
	<option value="December">December</option>
</select>
</td>
<td>
<select name="DOBDay">
	<option> - Day - </option>
	<option value="1">1</option>
	<option value="2">2</option>
	<option value="3">3</option>
	<option value="4">4</option>
	<option value="5">5</option>
	<option value="6">6</option>
	<option value="7">7</option>
	<option value="8">8</option>
	<option value="9">9</option>
	<option value="10">10</option>
	<option value="11">11</option>
	<option value="12">12</option>
	<option value="13">13</option>
	<option value="14">14</option>
	<option value="15">15</option>
	<option value="16">16</option>
	<option value="17">17</option>
	<option value="18">18</option>
	<option value="19">19</option>
	<option value="20">20</option>
	<option value="21">21</option>
	<option value="22">22</option>
	<option value="23">23</option>
	<option value="24">24</option>
	<option value="25">25</option>
	<option value="26">26</option>
	<option value="27">27</option>
	<option value="28">28</option>
	<option value="29">29</option>
	<option value="30">30</option>
	<option value="31">31</option>
</select>
</td>
<td>
<select name="DOBYear">
	<option> - Year - </option>
	<option value="1993">1993</option>
	<option value="1992">1992</option>
	<option value="1991">1991</option>
	<option value="1990">1990</option>
	<option value="1989">1989</option>
	<option value="1988">1988</option>
	<option value="1987">1987</option>
	<option value="1986">1986</option>
	<option value="1985">1985</option>
	<option value="1984">1984</option>
	<option value="1983">1983</option>
	<option value="1982">1982</option>
	<option value="1981">1981</option>
	<option value="1980">1980</option>
	<option value="1979">1979</option>
	<option value="1978">1978</option>
	<option value="1977">1977</option>
	<option value="1976">1976</option>
	<option value="1975">1975</option>
	<option value="1974">1974</option>
	<option value="1973">1973</option>
	<option value="1972">1972</option>
	<option value="1971">1971</option>
	<option value="1970">1970</option>
	<option value="1969">1969</option>
	<option value="1968">1968</option>
	<option value="1967">1967</option>
	<option value="1966">1966</option>
	<option value="1965">1965</option>
	<option value="1964">1964</option>
	<option value="1963">1963</option>
	<option value="1962">1962</option>
	<option value="1961">1961</option>
	<option value="1960">1960</option>
	<option value="1959">1959</option>
	<option value="1958">1958</option>
	<option value="1957">1957</option>
	<option value="1956">1956</option>
	<option value="1955">1955</option>
	<option value="1954">1954</option>
	<option value="1953">1953</option>
	<option value="1952">1952</option>
	<option value="1951">1951</option>
	<option value="1950">1950</option>
	<option value="1949">1949</option>
	<option value="1948">1948</option>
	<option value="1947">1947</option>
	
</select></td>
</tr>
</table>
<input type="button" value="register" id="register" <!--onclick="validate()"-->></button>
    

  <!-- </form> -->
</div>
</body>
<script>
	var mysql = require('mysql');
	var attempt = 3;

        function el(selector) {
            return document.getElementById(selector);
        }

        el('login').addEventListener('click', function(){
            // Get the mysql service
			console.log('Working!');
			//window.location.href = "./mymusic.html";
            getLogin(function(rows){
                if (rows.length > 0) {
					if (rows) {
						require('electron').remote.getGlobal('user').userName = rows[0].Username;
						console.log('User: ' + rows[0].Username);
						window.location.href = "./mymusic.html";
					}
				}
				else{
					console.log("No one found!");
					attempt --;// Decrementing by one.
					alert("Not a valid email/password. You have "+attempt+" attempt(s) left");
				}
				if( attempt == 0){
					document.getElementById("email").disabled = true;
					document.getElementById("password").disabled = true;
					document.getElementById("login").disabled = true;
					return false;
				}		
            });
        },false);
		
		el('register').addEventListener('click', function(){
            // Get the mysql service
			console.log('Working!');
			//window.location.href = "./mymusic.html";
            getRegister(function(rows){
					require('electron').remote.getGlobal('user').userName = newUser.value;
					console.log('User: ' + newUser.value);
					window.location.href = "./mymusic.html";
			});
        },false);

        function getLogin(callback){
            var mysql = require('mysql');

            // Add the credentials to access your database
            var connection = mysql.createConnection({
                host     : 'localhost',
                user     : 'root',
                password : null,
                database : 'moodify'
            });

            // connect to mysql
            connection.connect(function(err) {
                // in case of error
                if(err){
                    console.log(err.code);
                    console.log(err.fatal);
                }
            });

            // Perform a query
			//$query = 'SELECT * from `users`';
            //$query = 'SELECT `Username`,`Email`,`Password` FROM `users` where `users`.`Password`=Test';
			//$query = "SELECT Username,Email,Password FROM users WHERE Password='Test'";
			console.log('Email: ' + email.value);
			console.log('Password: ' + password.value);
            connection.query("SELECT * FROM users WHERE Email=? AND Password=?", [email.value, password.value], function(err, rows, fields) {
                if(err){
                    console.log("An error ocurred performing the query.");
                    console.log(err);
                    return;
                }
				else{
					callback(rows);
				}
                console.log("Query succesfully executed");
            });

            // Close the connection
            connection.end(function(){
                // The connection has been closed
            });
        }
	
	        function getRegister(callback){
            var mysql = require('mysql');

            // Add the credentials to access your database
            var connection = mysql.createConnection({
                host     : 'localhost',
                user     : 'root',
                password : null,
                database : 'moodify'
            });

            // connect to mysql
            connection.connect(function(err) {
                // in case of error
                if(err){
                    console.log(err.code);
                    console.log(err.fatal);
                }
				console.log("1 record inserted");
            });

            // Perform a query
			//$query = 'SELECT * from `users`';
            //$query = 'SELECT `Username`,`Email`,`Password` FROM `users` where `users`.`Password`=Test';
			//$query = "SELECT Username,Email,Password FROM users WHERE Password='Test'";
			console.log('Email: ' + email.value);
			console.log('Password: ' + password.value);
			 var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
			if(re.test(newEmail.value)){
				var values = [[newUser.value, newEmail.value,newPassword.value]];
				connection.query("INSERT INTO users (Username, Email, Password) VALUES ?", [values], function(err, rows, fields) {
					if(err){
						console.log("An error ocurred performing the query.");
						console.log(err);
						return;
					}

					callback(rows);

					console.log("Query succesfully executed");
				});
			}
			else{
				console.log("No one found!");
				attempt --;// Decrementing by one.
				alert("Not a valid registration. You have "+attempt+" attempt(s) left");
			}
			if( attempt == 0){
				document.getElementById("newUser").disabled = true;
				document.getElementById("newEmail").disabled = true;
				document.getElementById("newPassword").disabled = true;
				document.getElementById("register").disabled = true;
				return false;
			}
			else
				return;

            // Close the connection
            connection.end(function(){
                // The connection has been closed
            });
        }
	
	</script>
    <!--<script> -->
      <!-- require('./validate.js') -->
    <!-- </script> -->
<footer>
  <p>Team 404 Stress Not Found</p>
  <p>CSCI-8700 Fall 2017</p>
</footer>

</html>